# Webサービス「質問箱」非機能要件定義書

## 1. パフォーマンス要件

### 1.1. レスポンス時間
| 項目 | 目標値 | 最大許容値 | 備考 |
| :--- | :--- | :--- | :--- |
| **ページ読み込み時間** | 2秒以内 | 3秒以内 | 初回アクセス時 |
| **API レスポンス時間** | 300ms以内 | 500ms以内 | 通常のCRUD操作 |
| **画像アップロード** | 5秒以内 | 10秒以内 | 5MB以下のファイル |
| **質問一覧取得** | 500ms以内 | 1秒以内 | ページネーション含む |

### 1.2. スループット
| 項目 | 目標値 | 備考 |
| :--- | :--- | :--- |
| **同時接続ユーザー数** | 100ユーザー | 通常運用時 |
| **ピーク時同時接続** | 500ユーザー | 短期間のバースト |
| **API リクエスト/秒** | 100 req/sec | 平均値 |

## 2. 可用性要件

### 2.1. 稼働率
- **目標稼働率**: 99.0%（月間ダウンタイム: 約7.2時間）
- **計画メンテナンス**: 月1回、最大4時間
- **障害対応時間**: 平均復旧時間 2時間以内

### 2.2. バックアップ・復旧
- **データベースバックアップ**: 日次フルバックアップ
- **ファイルストレージバックアップ**: 週次バックアップ
- **復旧時間目標（RTO）**: 4時間以内
- **復旧ポイント目標（RPO）**: 24時間以内

## 3. セキュリティ要件

### 3.1. 認証・認可
- **パスワードポリシー**: 最小8文字、大文字・小文字・数字・記号を含む
- **セッション管理**: JWT トークン、有効期限24時間
- **アカウントロック**: 5回連続ログイン失敗で15分間ロック

### 3.2. データ保護
- **通信暗号化**: HTTPS（TLS 1.2以上）必須
- **パスワード暗号化**: bcrypt（コスト12以上）
- **個人情報保護**: メールアドレスの暗号化保存を検討

### 3.3. ファイルセキュリティ
- **アップロード制限**: 
  - ファイル形式: JPEG, PNG, GIF のみ
  - ファイルサイズ: 最大5MB
  - 画像サイズ: 最大4000x4000px
- **ウイルススキャン**: アップロード時のマルウェアチェック（検討中）

## 4. 拡張性要件

### 4.1. ユーザー数の拡張性
- **初期想定**: 1,000ユーザー
- **1年後目標**: 10,000ユーザー
- **スケールアウト対応**: データベース読み取りレプリカ対応

### 4.2. データ容量
- **データベース容量**: 初期10GB、年間50GB増加を想定
- **ファイルストレージ**: 初期100GB、年間500GB増加を想定

## 5. 運用・保守性要件

### 5.1. ログ・監視
- **アプリケーションログ**: 構造化ログ（JSON形式）
- **ログレベル**: ERROR, WARN, INFO, DEBUG
- **ログ保存期間**: 3ヶ月
- **監視項目**: 
  - サーバーリソース（CPU、メモリ、ディスク）
  - API レスポンス時間
  - エラー率

### 5.2. デプロイ・更新
- **デプロイ方式**: Blue-Green デプロイメント（検討中）
- **ロールバック**: 15分以内での前バージョンへの復旧
- **定期更新**: セキュリティアップデート月1回

## 6. ユーザビリティ要件

### 6.1. 対応環境
- **ブラウザサポート**: 
  - Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
  - モバイルブラウザ対応必須
- **レスポンシブデザイン**: スマートフォン、タブレット、PC対応

### 6.2. アクセシビリティ
- **WCAG準拠**: WCAG 2.1 AA レベル準拠を目標
- **キーボードナビゲーション**: 全機能のキーボード操作対応
- **スクリーンリーダー**: NVDA, JAWS での動作確認

## 7. 法的・コンプライアンス要件

### 7.1. プライバシー
- **個人情報取扱**: 利用目的の明示、同意取得
- **データ削除**: アカウント削除時の完全データ削除
- **匿名性保護**: 質問者の匿名性を技術的に保証

### 7.2. コンテンツモデレーション
- **NGワード機能**: ユーザー設定可能
- **通報機能**: 不適切コンテンツの報告システム
- **コンテンツ削除**: 運営判断による削除機能

## 決定が必要な項目

### 高優先度
1. **具体的なレスポンス時間目標値の調整**
2. **画像アップロードサイズ制限の最終決定**
3. **バックアップ戦略の詳細設計**
4. **ログ監視ツールの選定**

### 中優先度  
5. **ウイルススキャン機能の実装可否**
6. **Blue-Green デプロイメントの採用可否**
7. **データベース暗号化の実装範囲**

### 低優先度
8. **将来的な CDN 導入の検討**
9. **国際化対応の必要性**